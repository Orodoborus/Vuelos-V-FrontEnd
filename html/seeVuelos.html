<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>V-Vuelos ULACIT</title>
        <link rel="icon" type="image/x-icon" href="../assets/img/favicon.png" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../css/styles.css" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" href="#page-top"><img src="../assets/img/favicon.png" /></a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars ml-1"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav text-uppercase ml-auto" id="userNav">
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#services">Inicio</a></li>
                        <li class="nav-item"><a class="nav-link" href="/html/seeVuelos.html">Vuelos</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#team">Sobre Nosotros</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#logInReg">Login</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead">
            <div class="container">

                <div class="masthead-heading text-uppercase">Explorador de Vuelos</div>

                <div class="masthead-subheading">Seleccione una opción para iniciar: </div>            
                
<!-- Son input radios con cara de boton-->
                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                    <label class="btn btn-primary active">
                      <input type="radio" name="options" id="buyflight" autocomplete="off" checked><span class="material-icons">add_shopping_cart</span> Compras - Reservas
                    </label>
                    <label class="btn btn-secondary">
                      <input type="radio" name="options" id="salida" autocomplete="off">
                      <span class="material-icons">flight_takeoff</span>
                        Salidas
                    </label>
                    <label class="btn btn-secondary">
                      <input type="radio" name="options" id="llegada" autocomplete="off"><span class="material-icons">flight_land</span> Llegadas
                    </label>
                  </div>
            </div>
        </header>
        

<!-- Target para Filtros-->


        <section class="page-section-mini bg-gray" id="search">
            
        </section>

        <!-- Target para Tablas Dinamicas-->

        <section class="page-section" id="displaytablas">

            <table class="table">
                <thead>
                    <th style="text-align: center;">Codigo de Vuelo</th>
                    <th style="text-align: center;">Agencia</th>
                    <th style="text-align: center;">Pais</th>
                    <th style="text-align: center;">Fecha</th>
                    <th style="text-align: center;">Hora</th>
                    <th style="text-align: center;">Estado</th>
                    <th style="text-align: center;">Puerta</th>
                    <th style="text-align: center;">Precio</th>
                    <th></th>
                </thead>
                <tbody id="flightList" style="text-align: center;">

                </tbody>
            </table>
            </section>

        
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-left">Copyright © V-Vuelos 2021</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-right">
                        <a class="mr-3" href="#!">Privacy Policy</a>
                        <a href="#!">Terms of Use</a>
                    </div>
                </div>
            </div>
        </footer>
        

        

        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
        <!-- Contact form JS-->
        <script src="assets/mail/jqBootstrapValidation.js"></script>
        <script src="assets/mail/contact_me.js"></script>

        <script>
            if(localStorage.getItem("User") != null){
                document.getElementById('userNav').innerHTML = '';
                document.getElementById('userNav').innerHTML = `
                <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#services">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#team">Sobre Nosotros</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/seeVuelos.html">Vuelos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Reservas</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Compras</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/carrito.html">Carrito</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" value="${localStorage.getItem("User")}">${localStorage.getItem("User")}</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" onclick="logout()">LogOut</a></li>
                `;
            }
            const logout = function(){
                localStorage.removeItem("User");
                localStorage.removeItem("Rol");
                window.location.href = "../index.html";
            }

        </script>

        <script>
            let flightList = [];
            let info2 = [];
            let existflight2 = [];
            let specificflight2 = [];

            let info3 = [];
    let existflight3 = [];
    let specificflight3 = [];
            
                    const getSalidasArribo = async ()=>{
        flightList = document.querySelector('#flightList');
        flightList.innerHTML = '';
        existflight2 = await fetch('http://localhost:50498/api/VuelosSArribo').then(response => response.json());
        var length = Object.keys(existflight2).length;
        for (let index = 0; index < length; index++) {
            info2 = await fetch('http://localhost:50498/api/VuelosSArribo/'+index).then(response => response.json());
            specificflight2[index] = info2;
        }
        flightList.innerHTML = specificflight2.map(e=>{
            return `
            <tr>
            <td style="text-align: center;">${e.Codigo_Vuelo}</td>
                            <td style="text-align: center;">${e.Aerolinea}</td>
                            <td style="text-align: center;">${e.Cod_Pais_FK}</td>
                            <td style="text-align: center;">${e.Fecha}</td>
                            <td style="text-align: center;">${e.Hora}</td>
                            <td style="text-align: center;">${e.Estado}</td>
                            <td style="text-align: center;">${e.Cod_Puerta_FK}</td>
                            <td style="text-align: center;">N/A</td>
            </tr>`
        })
        search = document.querySelector('#search');
        search.innerHTML = `
        <div class="masthead-subheading">Filtrar: </div>
            <button class="btn btn-primary" onclick="window.location.href = 'seeVuelos.html'">Volver</button>
        `;
    }

    const getLlegadasArribo = async ()=>{
        flightList = document.querySelector('#flightList');
        flightList.innerHTML = '';
        existflight3 = await fetch('http://localhost:50498/api/VuelosYArribo').then(response => response.json());
        var length = Object.keys(existflight3).length;
        for (let index = 0; index < length; index++) {
            info3 = await fetch('http://localhost:50498/api/VuelosYArribo/'+index).then(response => response.json());
            specificflight3[index] = info3;
        }
        flightList.innerHTML = specificflight3.map(e=>{
            return `
            <tr>
            <td style="text-align: center;">${e.Codigo_Vuelo}</td>
                            <td style="text-align: center;">${e.Aerolinea}</td>
                            <td style="text-align: center;">${e.Cod_Pais_FK}</td>
                            <td style="text-align: center;">${e.Fecha}</td>
                            <td style="text-align: center;">${e.Hora}</td>
                            <td style="text-align: center;">${e.Estado}</td>
                            <td style="text-align: center;">${e.Cod_Puerta_FK}</td>
                            <td style="text-align: center;">N/A</td>
            </tr>`
        })
        search = document.querySelector('#search');
        search.innerHTML = `
        <div class="masthead-subheading">Filtrar: </div>
        <button class="btn btn-primary" onclick="window.location.href = 'seeVuelos.html'">Volver</button>
        `;
    }

        const addCart = async (codigo, pais, precio)=>{
            if(localStorage.getItem('User') == null){
                alert('Debe estar ingresado como usuario para añadir a carrito y comprar o reservar.\nSera direccionad@ al login o registro.')
                window.location.href = 'http://192.168.56.1:5500/index.html#logInReg';
            }else{
                /* INSERT INTO CART */
                     var sendFilter = await fetch('http://localhost:50498/api/Carrito',{
                          method:'POST',
                         headers:{
                                 'Content-Type':'application/json'
                              },
                         body:JSON.stringify({
                            Codigo_Vuelo: codigo,
                            Pais: pais,
                            Precio: precio
                         })
                     })
                     alert('Agregado al carrito!');

        
            }
        }
        </script>


        <!-- Core theme JS-->
        <script src="../js/scripts.js"></script>

        <script>
            /*const cap = function(){
            var caracteres = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V'
            ,'W','X','Y','Z','1','2','3','4','5','6','7','8','9','0','a','b','c','d','e','f','g','h','i',
            'j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z', '!','@','#','$','%','^','&','*','+']
                 var a = caracteres[Math.floor(Math.random()*71)];
                 var b = caracteres[Math.floor(Math.random()*71)];
                 var c = caracteres[Math.floor(Math.random()*71)];
                 var d = caracteres[Math.floor(Math.random()*71)];
                 var e = caracteres[Math.floor(Math.random()*71)];
                 var f = caracteres[Math.floor(Math.random()*71)];

                 var final = a+b+c+d+e+f;
                 document.getElementById("capt").value=final;
            }
            cap(); */
        </script>

        <!--Log In JS-->
       <!-- <script src="../js/login.js"></script>-->
        <script src="../js/seeVuelos.js"></script>
        
        
    </body>
</html>
