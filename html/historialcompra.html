<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>V-Vuelos ULACIT</title>
        <link rel="icon" type="image/x-icon" href="../assets/img/favicon.png" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../css/styles.css" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" href="#page-top"><img src="../assets/img/favicon.png" /></a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars ml-1"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav text-uppercase ml-auto" id="userNav">
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#services">Inicio</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#portfolio">Explorar Vuelos</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#team">Sobre Nosotros</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#logInReg">Login</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead">
            <div class="container" >

                <div class="masthead-heading text-uppercase">Historial</div>

                <div class="masthead-subheading">Compras</div>   

                </div>
        </header>

        <hr>

        <table class="table" id="table1">
            <thead style="text-align: center;">
                <th>Codigo_Compras</th>
                <th>Cantidad</th>
                <th>Total</th>
                <th>Fecha de Compra</th>
                <th></th>
            </thead>
            <tbody id="historialcomprastable" style="text-align: center;">

            </tbody>
        </table>

        <table class="table"  id="table2">
            <thead style="text-align: center;">
                <th>Codigo de Compra</th>
                <th>Codigo de Vuelo</th>
                <th>Pais</th>
                <th>Precio</th>
                <th></th>
            </thead>
            <tbody id="historialcomprastableDetails" style="text-align: center;">

            </tbody>
        </table>

        <center>
        <button class="btn btn-primary" style="visibility: hidden;" id="backFromDetails" onclick="window.location.href = 'historialcompra.html'">Volver</button>
    </center>

              
            </div>
          </div>
        </center>


            
        


        
<footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-left">Copyright V-Vuelos 2021</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-dark btn-social mx-2" href="#!"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                    <div class="col-lg-4 text-lg-right">
                        <a class="mr-3" href="#!">Privacy Policy</a>
                        <a href="#!">Terms of Use</a>
                    </div>
                </div>
            </div>
</footer>
        

        

        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
        

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
    
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
        <!-- Contact form JS-->
        <script src="assets/mail/jqBootstrapValidation.js"></script>
        <script src="assets/mail/contact_me.js"></script>

        <script>
            if(localStorage.getItem("User") != null){
                document.getElementById('userNav').innerHTML = '';
                document.getElementById('userNav').innerHTML = `
                <li class="nav-item"><a class="nav-link js-scroll-trigger" href="../index.html#services">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="../index.html#team">Sobre Nosotros</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/seeVuelos.html">Vuelos</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/historialreservas.html">Reservas</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/historialcompra.html">Compras</a></li>
                    <li class="nav-item"><a class="nav-link" href="/html/carrito.html">Carrito</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" value="${localStorage.getItem("User")}">${localStorage.getItem("User")}</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" onclick="logout()">LogOut</a></li>
                `;
            }
            const logout = async function(){
                localStorage.removeItem("User");
                localStorage.removeItem("Rol");
                var cartClean = await fetch('http://localhost:50498/api/logoutOrBuy/0',{
            method:'DELETE',
            headers:{
                'Content-Type':'application/json'
            },
            body:JSON.stringify({

            })
        }) 
                window.location.href = "../index.html";
            }

        </script>

        <script>


     const getMyDetail = async (codBUY, codUSER) =>{
        var getMydetail = await fetch('http://localhost:50498/api/buyingdetails',{
            method:'POST',
            headers:{
                'Content-Type':'application/json'
            },
            body:JSON.stringify({
                Codigo_Compra: codBUY,
                Codigo_User: codUSER
            })
        })
         

        let historialcomprastable = [];
        let historialcomprastableDetails = [];
         let info2 =[];
         let exBuy2 = [];
        let SpecificBuy2 = [];

        document.querySelector('#historialcomprastable').style.display = "none";
        document.querySelector('#table1').style.display = "none";
        historialcomprastableDetails = document.querySelector('#historialcomprastableDetails').style.visibility = "visible";
        table2 = document.querySelector('#table2').style.visibility = "visible";
        document.querySelector('#backFromDetails').style.visibility = "visible";

        const getMyNiceDetail = async () =>{
            historialcomprastableDetails = document.querySelector('#historialcomprastableDetails');
        historialcomprastable.innerHTML = '';
        exBuy2 = await fetch('http://localhost:50498/api/buyingdetails').then(response => response.json());
        var length = Object.keys(exBuy2).length;
        for (let index = 0; index < length; index++) {
            info2 = await fetch('http://localhost:50498/api/buyingdetails/'+index).then(response => response.json());
            SpecificBuy2[index] = info2;
        }
        historialcomprastableDetails.innerHTML = SpecificBuy2.map(e=>{
            return`
            <tr>
                <td>${e.Codigo_Compra}</td>
                <td>${e.Codigo_Vuelo}</td>
                <td>${e.Pais}</td>
                <td>${e.Precio}</td>
                <td></td>
            </tr>
            `
        });
        }

        getMyNiceDetail();

    }
        </script>

        <script src="../js/compras.js"></script>

        <!-- Core theme JS-->
        <script src="../js/scripts.js"></script>

        <script>
            /*const cap = function(){
            var caracteres = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V'
            ,'W','X','Y','Z','1','2','3','4','5','6','7','8','9','0','a','b','c','d','e','f','g','h','i',
            'j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z', '!','@','#','$','%','^','&','*','+']
                 var a = caracteres[Math.floor(Math.random()*71)];
                 var b = caracteres[Math.floor(Math.random()*71)];
                 var c = caracteres[Math.floor(Math.random()*71)];
                 var d = caracteres[Math.floor(Math.random()*71)];
                 var e = caracteres[Math.floor(Math.random()*71)];
                 var f = caracteres[Math.floor(Math.random()*71)];

                 var final = a+b+c+d+e+f; 
                // document.getElementById("capt").value=final;
            }*/
           // cap();
        </script>

        <!--Log In JS-->


        
        
    </body>
</html>